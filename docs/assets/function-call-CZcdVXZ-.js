import{m as U,u as z}from"./mount-component-DO70U7a7.js";import{d as S,r as E,c as o,a as D,k as M,D as W,m as I}from"./index-BRYTmIyP.js";import{p as q,a as V,P as Y}from"./index-Caave46l.js";import{B as p}from"./index-KzW-Uw1Q.js";import{c as T,u as j,t as k,w as N,e as h,a as G,n as J,k as Q,r as X,q as Z,o as ee,s as O,v as te,x as ne}from"./index-4pUri2OV.js";import{u as oe}from"./use-placeholder-js-WKF-8.js";import{u as ae}from"./use-expose-N8why80i.js";import{r as le,u as se}from"./use-route-DOGmHK4u.js";import{a as re,b as ce}from"./constant-Co2M3aoe.js";import{c as ie}from"./on-popup-reopen-ebgq6Xfv.js";const[R,A]=T("action-bar"),F=Symbol(R),ue={placeholder:Boolean,safeAreaInsetBottom:k};var de=S({name:R,props:ue,setup(e,{slots:a}){const n=E(),s=oe(n,A),{linkChildren:r}=j(F);r();const m=()=>{var f;return o("div",{ref:n,class:[A(),{"van-safe-area-bottom":e.safeAreaInsetBottom}]},[(f=a.default)==null?void 0:f.call(a)])};return()=>e.placeholder?s(m):m()}});const me=N(de),[fe,Be]=T("action-bar-button"),ge=h({},le,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var he=S({name:fe,props:ge,setup(e,{slots:a}){const n=se(),{parent:s,index:r}=G(F),m=D(()=>{if(s){const c=s.children[r.value-1];return!(c&&"isButton"in c)}}),f=D(()=>{if(s){const c=s.children[r.value+1];return!(c&&"isButton"in c)}});return ae({isButton:!0}),()=>{const{type:c,icon:B,text:g,color:w,loading:v,disabled:y}=e;return o(p,{class:Be([c,{last:f.value,first:m.value}]),size:"large",type:c,icon:B,color:w,loading:v,disabled:y,onClick:n},{default:()=>[a.default?a.default():g]})}}});const _=N(he),[Ce,i,b]=T("dialog"),be=h({},q,{title:String,theme:String,width:J,message:[String,Function],callback:Function,allowHtml:Boolean,className:Q,transition:X("van-dialog-bounce"),messageAlign:String,closeOnPopstate:k,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:k,closeOnClickOverlay:Boolean}),we=[...V,"transition","closeOnPopstate"];var ve=S({name:Ce,props:be,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:a,slots:n}){const s=E(),r=M({confirm:!1,cancel:!1}),m=t=>a("update:show",t),f=t=>{var l;m(!1),(l=e.callback)==null||l.call(e,t)},c=t=>()=>{e.show&&(a(t),e.beforeClose?(r[t]=!0,ie(e.beforeClose,{args:[t],done(){f(t),r[t]=!1},canceled(){r[t]=!1}})):f(t))},B=c("cancel"),g=c("confirm"),w=W(t=>{var l,u;if(t.target!==((u=(l=s.value)==null?void 0:l.popupRef)==null?void 0:u.value))return;({Enter:e.showConfirmButton?g:O,Escape:e.showCancelButton?B:O})[t.key](),a("keydown",t)},["enter","esc"]),v=()=>{const t=n.title?n.title():e.title;if(t)return o("div",{class:i("header",{isolated:!e.message&&!n.default})},[t])},y=t=>{const{message:l,allowHtml:u,messageAlign:d}=e,C=i("message",{"has-title":t,[d]:d}),P=te(l)?l():l;return u&&typeof P=="string"?o("div",{class:C,innerHTML:P},null):o("div",{class:C},[P])},H=()=>{if(n.default)return o("div",{class:i("content")},[n.default()]);const{title:t,message:l,allowHtml:u}=e;if(l){const d=!!(t||n.title);return o("div",{key:u?1:0,class:i("content",{isolated:!d})},[y(d)])}},K=()=>o("div",{class:[ce,i("footer")]},[e.showCancelButton&&o(p,{size:"large",text:e.cancelButtonText||b("cancel"),class:i("cancel"),style:{color:e.cancelButtonColor},loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(p,{size:"large",text:e.confirmButtonText||b("confirm"),class:[i("confirm"),{[re]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),$=()=>o(me,{class:i("footer")},{default:()=>[e.showCancelButton&&o(_,{type:"warning",text:e.cancelButtonText||b("cancel"),class:i("cancel"),color:e.cancelButtonColor,loading:r.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(_,{type:"danger",text:e.confirmButtonText||b("confirm"),class:i("confirm"),color:e.confirmButtonColor,loading:r.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),L=()=>n.footer?n.footer():e.theme==="round-button"?$():K();return()=>{const{width:t,title:l,theme:u,message:d,className:C}=e;return o(Y,I({ref:s,role:"dialog",class:[i([u]),C],style:{width:ee(t)},tabindex:0,"aria-labelledby":l||d,onKeydown:w,"onUpdate:show":m},Z(e,we)),{default:()=>[v(),H(),L()]})}}});let x;const ye={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Pe=h({},ye);function pe(){({instance:x}=U({setup(){const{state:a,toggle:n}=z();return()=>o(ve,I(a,{"onUpdate:show":n}),null)}}))}function ke(e){return ne?new Promise((a,n)=>{x||pe(),x.open(h({},Pe,e,{callback:s=>{(s==="confirm"?a:n)(s)}}))}):Promise.resolve(void 0)}const Re=e=>ke(h({showCancelButton:!0},e));export{Re as a,ve as b,ke as s};
