import{r as oe,u as ae,f as le,p as N,T as Y,P as se,c as ce,H as ie}from"./use-route-B7CSn7qS.js";import{c as D,e as E,s as re,n as x,d as I,f as ue,w as L,I as X,t as O,u as j,g as de,a as G}from"./index-Dx5oZIrL.js";import{c,d as R,a as V,r as y,I as Z,J as fe,A as K,g as ve,K as q,n as J,E as W,C as ye,L as me,M as ge,T as he,F as Ie,m as M,H as Se}from"./index-Fxc2rSLZ.js";import{o as be,h as xe,c as Q}from"./index.esm-Pm4_1N2A.js";import{u as Ce}from"./use-expose-BD6BJhaI.js";let Pe=2e3;const Oe=()=>++Pe,[ke,T]=D("loading"),Te=Array(12).fill(null).map((e,t)=>c("i",{class:T("line",String(t+1))},null)),ze=c("svg",{class:T("circular"),viewBox:"25 25 50 50"},[c("circle",{cx:"50",cy:"50",r:"20",fill:"none"},null)]),we={size:x,type:I("circular"),color:String,vertical:Boolean,textSize:x,textColor:String};var Be=R({name:ke,props:we,setup(e,{slots:t}){const n=V(()=>E({color:e.color},re(e.size))),u=()=>{const o=e.type==="spinner"?Te:ze;return c("span",{class:T("spinner",e.type),style:n.value},[t.icon?t.icon():o])},a=()=>{var o;if(t.default)return c("span",{class:T("text"),style:{fontSize:ue(e.textSize),color:(o=e.textColor)!=null?o:e.color}},[t.default()])};return()=>{const{type:o,vertical:l}=e;return c("div",{class:T([o,{vertical:l}]),"aria-live":"polite","aria-busy":!0},[u(),a()])}}});const _e=L(Be),[Ae,P]=D("button"),De=E({},oe,{tag:I("button"),text:String,icon:String,type:I("default"),size:I("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:I("button"),loadingSize:x,loadingText:String,loadingType:String,iconPosition:I("left")});var Ee=R({name:Ae,props:De,emits:["click"],setup(e,{emit:t,slots:n}){const u=ae(),a=()=>n.loading?n.loading():c(_e,{size:e.loadingSize,type:e.loadingType,class:P("loading")},null),o=()=>{if(e.loading)return a();if(n.icon)return c("div",{class:P("icon")},[n.icon()]);if(e.icon)return c(X,{name:e.icon,class:P("icon"),classPrefix:e.iconPrefix},null)},l=()=>{let s;if(e.loading?s=e.loadingText:s=n.default?n.default():e.text,s)return c("span",{class:P("text")},[s])},i=()=>{const{color:s,plain:d}=e;if(s){const f={color:d?s:"white"};return d||(f.background=s),s.includes("gradient")?f.border=0:f.borderColor=s,f}},b=s=>{e.loading?N(s):e.disabled||(t("click",s),u())};return()=>{const{tag:s,type:d,size:f,block:C,round:v,plain:m,square:h,loading:g,disabled:z,hairline:w,nativeType:$,iconPosition:B}=e,_=[P([d,f,{plain:m,block:C,round:v,square:h,loading:g,disabled:z,hairline:w}]),{[le]:w}];return c(s,{type:$,class:_,style:i(),disabled:z,onClick:b},{default:()=>[c("div",{class:P("content")},[B==="left"&&o(),l(),B==="right"&&o()])]})}}});const qe=L(Ee),ee={show:Boolean,zIndex:x,overlay:O,duration:x,teleport:[String,Object],lockScroll:O,lazyRender:O,beforeClose:Function,overlayStyle:Object,overlayClass:j,transitionAppear:Boolean,closeOnClickOverlay:O},Je=Object.keys(ee);function Le(e,t){return e>t?"horizontal":t>e?"vertical":""}function Re(){const e=y(0),t=y(0),n=y(0),u=y(0),a=y(0),o=y(0),l=y(""),i=y(!0),b=()=>l.value==="vertical",s=()=>l.value==="horizontal",d=()=>{n.value=0,u.value=0,a.value=0,o.value=0,l.value="",i.value=!0};return{move:v=>{const m=v.touches[0];n.value=(m.clientX<0?0:m.clientX)-e.value,u.value=m.clientY-t.value,a.value=Math.abs(n.value),o.value=Math.abs(u.value);const h=10;(!l.value||a.value<h&&o.value<h)&&(l.value=Le(a.value,o.value)),i.value&&(a.value>Y||o.value>Y)&&(i.value=!1)},start:v=>{d(),e.value=v.touches[0].clientX,t.value=v.touches[0].clientY},reset:d,startX:e,startY:t,deltaX:n,deltaY:u,offsetX:a,offsetY:o,direction:l,isVertical:b,isHorizontal:s,isTap:i}}let k=0;const F="van-overflow-hidden";function $e(e,t){const n=Re(),u="01",a="10",o=d=>{n.move(d);const f=n.deltaY.value>0?a:u,C=xe(d.target,e.value),{scrollHeight:v,offsetHeight:m,scrollTop:h}=C;let g="11";h===0?g=m>=v?"00":"01":h+m>=v&&(g="10"),g!=="11"&&n.isVertical()&&!(parseInt(g,2)&parseInt(f,2))&&N(d,!0)},l=()=>{document.addEventListener("touchstart",n.start),document.addEventListener("touchmove",o,{passive:!1}),k||document.body.classList.add(F),k++},i=()=>{k&&(document.removeEventListener("touchstart",n.start),document.removeEventListener("touchmove",o),k--,k||document.body.classList.remove(F))},b=()=>t()&&l(),s=()=>t()&&i();be(b),Z(s),fe(s),K(t,d=>{d?l():i()})}function te(e){const t=y(!1);return K(e,n=>{n&&(t.value=n)},{immediate:!0}),n=>()=>t.value?n():null}const H=()=>{var e;const{scopeId:t}=((e=ve())==null?void 0:e.vnode)||{};return t?{[t]:""}:null},[pe,Ne]=D("overlay"),Ke={show:Boolean,zIndex:x,duration:x,className:j,lockScroll:O,lazyRender:O,customStyle:Object};var Ye=R({name:pe,props:Ke,setup(e,{slots:t}){const n=y(),u=te(()=>e.show||!e.lazyRender),a=l=>{e.lockScroll&&N(l,!0)},o=u(()=>{var l;const i=E(de(e.zIndex),e.customStyle);return G(e.duration)&&(i.animationDuration=`${e.duration}s`),J(c("div",{ref:n,style:i,class:[Ne(),e.className]},[(l=t.default)==null?void 0:l.call(t)]),[[W,e.show]])});return Q("touchmove",a,{target:n}),()=>c(q,{name:"van-fade",appear:!0},{default:o})}});const Me=L(Ye),Fe=E({},ee,{round:Boolean,position:I("center"),closeIcon:I("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:I("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[He,U]=D("popup");var Ue=R({name:He,inheritAttrs:!1,props:Fe,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:t,attrs:n,slots:u}){let a,o;const l=y(),i=y(),b=te(()=>e.show||!e.lazyRender),s=V(()=>{const r={zIndex:l.value};if(G(e.duration)){const S=e.position==="center"?"animationDuration":"transitionDuration";r[S]=`${e.duration}s`}return r}),d=()=>{a||(a=!0,l.value=e.zIndex!==void 0?+e.zIndex:Oe(),t("open"))},f=()=>{a&&ce(e.beforeClose,{done(){a=!1,t("close"),t("update:show",!1)}})},C=r=>{t("clickOverlay",r),e.closeOnClickOverlay&&f()},v=()=>{if(e.overlay)return c(Me,M({show:e.show,class:e.overlayClass,zIndex:l.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},H(),{onClick:C}),{default:u["overlay-content"]})},m=r=>{t("clickCloseIcon",r),f()},h=()=>{if(e.closeable)return c(X,{role:"button",tabindex:0,name:e.closeIcon,class:[U("close-icon",e.closeIconPosition),ie],classPrefix:e.iconPrefix,onClick:m},null)};let g;const z=()=>{g&&clearTimeout(g),g=setTimeout(()=>{t("opened")})},w=()=>t("closed"),$=r=>t("keydown",r),B=b(()=>{var r;const{round:S,position:A,safeAreaInsetTop:p,safeAreaInsetBottom:ne}=e;return J(c("div",M({ref:i,style:s.value,role:"dialog",tabindex:0,class:[U({round:S,[A]:A}),{"van-safe-area-top":p,"van-safe-area-bottom":ne}],onKeydown:$},n,H()),[(r=u.default)==null?void 0:r.call(u),h()]),[[W,e.show]])}),_=()=>{const{position:r,transition:S,transitionAppear:A}=e,p=r==="center"?"van-fade":`van-popup-slide-${r}`;return c(q,{name:S||p,appear:A,onAfterEnter:z,onAfterLeave:w},{default:B})};return K(()=>e.show,r=>{r&&!a&&(d(),n.tabindex===0&&Se(()=>{var S;(S=i.value)==null||S.focus()})),!r&&a&&(a=!1,t("close"))}),Ce({popupRef:i}),$e(i,()=>e.show&&e.lockScroll),Q("popstate",()=>{e.closeOnPopstate&&(f(),o=!1)}),ye(()=>{e.show&&d()}),me(()=>{o&&(t("update:show",!0),o=!1)}),Z(()=>{e.show&&e.teleport&&(f(),o=!0)}),ge(se,()=>e.show),()=>e.teleport?c(he,{to:e.teleport},{default:()=>[v(),_()]}):c(Ie,null,[v(),_()])}});const We=L(Ue);export{qe as B,_e as L,We as P,Je as a,ee as p,Re as u};
